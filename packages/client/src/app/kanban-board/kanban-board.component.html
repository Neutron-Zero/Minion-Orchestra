<div class="kanban-board">
  <div class="kanban-column" *ngFor="let col of columns; trackBy: trackByColumn">
    <div class="column-header" [style.borderColor]="col.color">
      <span class="column-label">{{ col.label }}</span>
      <span class="column-count" [style.backgroundColor]="col.color"
            [style.color]="getCountTextColor(col.color)">{{ col.agents.length }}</span>
    </div>
    <div class="column-body">
      <div class="kanban-card"
           *ngFor="let agent of col.agents; trackBy: trackByAgent"
           [style.borderLeftColor]="getAgentColor(agent.id)">
        <div class="card-line-1">
          <span class="agent-id">{{ getFormattedAgentId(agent.id) }}</span>
          <span class="elapsed">{{ getElapsedTime(agent.startTime) }}</span>
        </div>
        <div class="card-task" *ngIf="agent.currentTask">{{ agent.currentTask }}</div>
        <div class="card-line-2">
          <span class="agent-folder" *ngIf="getFolderName(agent)">{{ getFolderName(agent) }}</span>
          <button class="focus-btn" matTooltip="Focus terminal" (click)="focus.emit(agent); $event.stopPropagation()">
            <mat-icon>terminal</mat-icon>
          </button>
        </div>
        <div class="card-line-3" *ngIf="agent.currentTool || agent.recentTools?.length">
          <span class="tool-pill" *ngIf="agent.currentTool">{{ agent.currentTool }}</span>
          <ng-container *ngIf="!agent.currentTool && agent.recentTools?.length">
            <span class="tool-pill recent" *ngFor="let tool of agent.recentTools?.slice(-3); trackBy: trackByTool">{{ tool }}</span>
          </ng-container>
        </div>
      </div>
      <div class="empty-column" *ngIf="col.agents.length === 0">
        No agents
      </div>
    </div>
  </div>
</div>
